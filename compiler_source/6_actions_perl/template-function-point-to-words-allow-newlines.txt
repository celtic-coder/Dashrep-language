# no-space dashes-long-line  <new_line>
# function__point_to_words_allow_newlines  <new_line>
#  <new_line>
#  Input is $global_source_text  <new_line>
#  Output is variable $global_number_of_words and array begin_position_for_word[ ] and array length_of_word[ ] where pointer into array is 1 for first word, etc.  <new_line>
#  Word counts start at one  <new_line>
#  Character pointer numbers start at zero  <new_line>
<new_line>

sub function__point_to_words_allow_newlines( ) {  <new_line>



$global_source_text = 'first second third' ;  <new_line>



$global_number_of_words = 0 ;  <new_line>
$global_length_of_text = length( $global_source_text ) ;  <new_line>

if ( $global_length_of_text < 1 ) {  <new_line>
return '' ;  <new_line>
}  <new_line>

$global_pointer_to_previous_space = -1 ;  <new_line>
$global_pointer_to_next_newline = index( $global_source_text , "\n" ) ;  <new_line>

# begin loop that exits in middle of loop  <new_line>
while ( 1 == 1 ) {  <new_line>
# reminder: a change in the code within this loop can cause an endless loop  <new_line>

$global_pointer_to_next_space = index( $global_source_text , ' ' , $global_pointer_to_previous_space + 1 ) ;  <new_line>
if ( $global_pointer_to_next_space < 0 ) {  <new_line>
$global_pointer_to_next_space = $global_length_of_word ;  <new_line>
}  <new_line>

if ( $global_pointer_to_next_space > $global_pointer_to_next_newline ) {  <new_line>
$global_pointer_to_next_space = $global_pointer_to_next_newline ;  <new_line>
$global_pointer_to_next_newline = index( $global_source_text , "\n" , $global_pointer_to_next_space + 1 ) ;  <new_line>
if ( $global_pointer_to_next_newline < 0 ) {  <new_line>
$global_pointer_to_next_newline = $global_length_of_word + 1 ;  <new_line>
}  <new_line>
}  <new_line>

if ( $global_pointer_to_next_space > $global_pointer_to_previous_space + 1 ) {  <new_line>
$global_number_of_words ++ ;  <new_line>
$global_begin_position_for_word[ $global_number_of_words ] = $global_pointer_to_previous_space + 1 ;  <new_line>
$global_length_of_word[ $global_number_of_words ] = $global_pointer_to_next_space - $global_pointer_to_previous_space - 1 ;  <new_line>

print "word number " . $global_number_of_words . " is: '" . substr( $global_source_text , $global_begin_position_for_word[ $global_number_of_words ] , $global_length_of_word[ $global_number_of_words ] ) . "'\n" ;  <new_line>

}  <new_line>

if ( ( $global_pointer_to_next_space >= $global_length_of_word ) && ( $global_pointer_to_next_newline >= $global_length_of_word ) ) {  <new_line>
last ;  <new_line>
}  <new_line>

$global_pointer_to_previous_space = $global_pointer_to_next_space ;  <new_line>

# end of dangerous, but fast, inner loop  <new_line>
}  <new_line>

if ( $global_pointer_to_previous_space < $global_length_of_text - 1 ) {  <new_line>
$global_number_of_words ++ ;  <new_line>
$global_begin_position_for_word[ $global_number_of_words ] = $global_pointer_to_previous_space + 1 ;  <new_line>
$global_length_of_word[ $global_number_of_words ] = $global_length_of_text - $global_pointer_to_previous_space - 1 ;  <new_line>
}  <new_line>

# print "word number " . $global_number_of_words . " is: '" . substr( $global_source_text , $global_begin_position_for_word[ $global_number_of_words ] , $global_length_of_word[ $global_number_of_words ] ) . "'\n" ;  <new_line>

template-function-segment-ending
